(function(){!function(e,t,n){var i,o,s,r,a,l,f,p,h;return l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),s=/Chrome/.test(navigator.userAgent),p=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)||/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),r=l&&/crios/i.test(navigator.userAgent),f=/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),a=navigator.appVersion.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>-1,h=/windows nt 6.2/.test(navigator.userAgent.toLowerCase())||/windows nt 6.3/.test(navigator.userAgent.toLowerCase()),o=null!=t.body.classList,i=function(){function i(t){this.options=e.extend(!0,{},this.Defaults,t),this.scenes=[],this.initialize(),this.scrollY=n.scrollY||n.pageYOffset,this.lastScrollY=-1,this.lastDocHeight=0,this.inputFocus=!1,this.checkLayerHeight=!1}var u,d;return u=function(){function e(e,n,i,o,s,r,f){switch(this.amend=p||a||l?60:0,this.element=e,this.aliases=n,this.type=e.getAttribute("data-type")||"html","html"===this.type&&(this.holder=this.createHolder()),this.direction="normal"===e.getAttribute("data-direction")||null==e.getAttribute("data-direction")?1:-1,this.fade="true"===e.getAttribute("data-fade"),this.blur="true"===e.getAttribute("data-blur"),this.boundTo=t.querySelector(e.getAttribute("data-bound-to")),"media"===this.type&&(this.url=e.getAttribute("data-url")),this.responsive=this.getResponsiveOptions(),!a&&!l||l||h&&a?this.element.style.position="absolute":this.element.style.position="fixed",this.type){case"media":null!=this.url&&(this.element.style["background-image"]="url("+this.url+")");break;case"html":a&&l&&(this.element.style["z-index"]=1)}this.refresh(i,o,s,r,f)}return e.prototype.refresh=function(e,t,n,i,o){var s;switch(s=this,s.speed=s.getOption("speed",e)||0,s.offset=s.getOption("offset",e)||0,l||h&&a||(o?s.element.style.position="fixed":s.element.style.position="absolute"),a&&"html"===s.type&&(s.element.style.position="absolute"),s.type){case"media":if(!a)return s.offsetHeight=s.getMediaHeight(t,i,s.speed,s.direction),s.element.style.height=s.offsetHeight+"px";break;case"html":if(s.element.style.width=this.holder.offsetWidth+"px",s.offsetHeight=s.element.offsetHeight,s.holder.style.height=s.offsetHeight+"px",!(!a&&!l||l||h&&a))return a?s.element.style.position="static":o&&(s.element.style.left=s.getOffset(s.holder).left+"px",s.element.style.top=s.getOffset(s.holder).top-n+"px"),s.holder.style.position="static";break;case"custom":return s.offsetHeight=s.element.offsetHeight}},e.prototype.createHolder=function(){var e,n;return n=this,e=t.createElement("div"),o?e.classList.add("rd-parallax-layer-holder"):e.className="rd-parallax-layer-holder",n.element.parentNode.insertBefore(e,n.element),e.appendChild(n.element),(!a&&!l||r)&&(e.style.position="relative"),e},e.prototype.isHolderWrong=function(){var e;return e=this,"html"===e.type&&e.holder.offsetHeight!==e.element.offsetHeight},e.prototype.getOption=function(e,t){var n,i,o;n=this;for(i in n.responsive)i<=t&&(o=i);return n.responsive[o][e]},e.prototype.getResponsiveOptions=function(){var e,t,n,i,o,s,r,a,l,f,p;f={},l=[],t=[],a=this.aliases;for(n in a)e=a[n],l.push(n),t.push(e);for(n=o=0,s=l.length;o<s;n=++o)for(r=l[n],f[r]={};(i=n)>=-1;)!f[r].speed&&(p=this.element.getAttribute("data"+t[i]+"speed"))&&(f[r].speed=this.getSpeed(p)),!f[r].offset&&(p=this.element.getAttribute("data"+t[i]+"offset"))&&(f[r].offset=parseInt(p)),!f[r].fade&&(p=this.element.getAttribute("data"+t[i]+"fade"))&&(f[r].fade="true"===p),n--;return f},e.prototype.fuse=function(e,t){var n,i,o,s,r,a;n=this,o=n.getOffset(n.element).top+n.element.getBoundingClientRect().top,a=e+t/2,i=o+n.offsetHeight/2,r=t/6,a+r>i&&a-r<i?n.element.style.opacity=1:(s=a-r<i?1+(a+r-i)/t/3*10:1-(a-r-i)/t/3*10,n.element.style.opacity=s<0?0:s>1?1:s.toFixed(2))},e.prototype.move=function(e,t,n,i,o,s,f,u,d){var g,c,m,y,v;if(m=this,!(a&&"media"===m.type||l||h&&a)){if(!f)return p&&(m.element.style["-webkit-transform"]="translate3d(0,0,0)"),void(m.element.style.transform="translate3d(0,0,0)");v=!l||"html"===m.type&&d||r?m.speed*m.direction:m.speed*m.direction-1,c=m.offsetHeight,null!=u?g=(i+n-(u+n))/(n-o):"media"!==m.type&&(i<n||i>s-n)?(g=i<n?i/(n-o):(i+n-s)/(n-o),isFinite(g)||(g=0)):g=.5,y=r||a?(o-c)/2+(n-o)*g*v+m.offset:l?-(i-e)*v+(o-c)/2+(n-o)*g*(v+1)+m.offset:-(i-e)*v+(o-c)/2+(n-o)*g*v+m.offset,l&&null!=u&&(m.element.style.top=i-u+"px"),p&&(this.element.style["-webkit-transform"]="translate3d(0,"+y+"px,0)"),this.element.style.transform="translate3d(0,"+y+"px,0)"}},e.prototype.getSpeed=function(e){return Math.min(Math.max(parseFloat(e),0),2)},e.prototype.getMediaHeight=function(e,t,n,i){var o;return o=i===-1?(t+e)*n:0,t+o+(n<=1?Math.abs(e-t)*n:e*n)+2*this.amend},e.prototype.getOffset=function(e){var t,i,o;return t=e.getBoundingClientRect(),i=t.left+(n.scrollX||n.pageXOffset),o=t.top+(n.scrollY||n.pageYOffset),{top:o,left:i}},e}(),d=function(){function i(e,n,i,o){var s;s=this,s.amend=p?60:0,s.element=e,s.aliases=n,s.on=!0,s.agent=t.querySelector(e.getAttribute("data-agent")),s.anchor=s.findAnchor(),s.canvas=s.createCanvas(),s.layers=s.createLayers(i),s.fitTo=s.getFitElement(),s.responsive=s.getResponsiveOptions(),s.refresh(i,o)}return i.prototype.getFitElement=function(){var e,n;return n=this,null!=(e=n.element.getAttribute("data-fit-to"))?"parent"===e?n.element.parentNode:t.querySelector(e):null},i.prototype.findAnchor=function(){var e,n;for(n=this,e=n.element.parentNode;null!=e&&e!==t;){if(n.isTransformed.call(e))return e;e=e.parentNode}return null},i.prototype.createCanvas=function(){var e,n;for(n=this,e=t.createElement("div"),o?e.classList.add("rd-parallax-inner"):e.className="rd-parallax-inner",n.element.appendChild(e);n.element.firstChild!==e;)e.appendChild(n.element.firstChild);return n.element.style.position="relative",n.element.style.overflow="hidden",a||l?(e.style.position="absolute",h&&a||(e.style.clip="rect(0, auto, auto, 0)"),a?e.style.transform="translate3d(0,0,0)":e.style.transform="none"):e.style.position="fixed",e.style.left=n.offsetLeft+"px",e.style.top=0,p&&(e.style["margin-top"]="-"+n.amend+"px",e.style.padding=n.amend+"px 0",n.element.style["z-index"]=0),e},i.prototype.getOption=function(e,t){var n,i;for(n in this.responsive)n<=t&&(i=n);return this.responsive[i][e]},i.prototype.getResponsiveOptions=function(){var e,t,n,i,o,s,r,a,l,f,p;f={},l=[],t=[],a=this.aliases;for(n in a)e=a[n],l.push(n),t.push(e);for(n=o=0,s=l.length;o<s;n=++o)for(r=l[n],f[r]={};(i=n)>=-1;)f[r].on||null==(p=this.element.getAttribute("data"+t[i]+"on"))||(f[r].on="false"!==p),null==f[r].on&&0===i&&(f[r].on=!0),n--;return f},i.prototype.createLayers=function(t,n){var i,o,s,r,a,l,f;for(f=this,o=e(f.element).find(".rd-parallax-layer").get(),a=[],s=r=0,l=o.length;r<l;s=++r)i=o[s],a.push(new u(i,f.aliases,t,n,f.offsetTop,f.offsetHeight,f.on));return a},i.prototype.move=function(e){var t,n;return n=this,t=null!=n.anchor?n.positionTop:n.offsetTop-e,p&&(n.canvas.style["-webkit-transform"]="translate3d(0,"+t+"px,0)"),n.canvas.style.transform="translate3d(0,"+t+"px,0)"},i.prototype.refresh=function(e,t){var n,i,o,s,r,a,l,f;for(f=this,a=[],f.on=f.getOption("on",e),f.offsetTop=f.getOffset(f.element).top,f.offsetLeft=f.getOffset(f.element).left,f.width=f.element.offsetWidth,f.canvas.style.width=f.width+"px",null!=f.anchor&&(f.positionTop=f.element.offsetTop),null!=f.agent?(f.agentOffset=f.getOffset(f.agent).top,f.agentHeight=f.agent.offsetHeight):f.agentOffset=f.agentHeight=null,l=f.layers,n=0,s=l.length;n<s;n++)o=l[n],"media"===o.type?a.push(o):o.refresh(e,t,f.offsetTop,f.offsetHeight,f.on);for(f.offsetHeight=f.canvas.offsetHeight-2*f.amend,f.element.style.height=f.offsetHeight+"px",i=0,r=a.length;i<r;i++)o=a[i],o.refresh(e,t,f.offsetTop,f.offsetHeight,f.on)},i.prototype.update=function(e,t,n,i,o){var s,r,f,p,h,u,d,g;for(u=this,g=u.offsetTop,d=u.offsetHeight,a||l||u.move(e),p=u.layers,h=[],s=0,f=p.length;s<f;s++)r=p[s],r.move(e,t,n,g,d,i,u.on,u.agentOffset,o),r.fade=r.getOption("fade",t)||!1,!r.fade||l||a?h.push(void 0):h.push(r.fuse(g,d));return h},i.prototype.isTransformed=function(){var e,t,i,o;e=this,o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(t in o)o.hasOwnProperty(t)&&null!=e.style[t]&&(i=n.getComputedStyle(e).getPropertyValue(o[t]));return null!=i&&i.length>0&&"none"!==i},i.prototype.getOffset=function(e){var t,i,o;return t=e.getBoundingClientRect(),i=t.left+(n.scrollX||n.pageYOffset),o=t.top+(n.scrollY||n.pageYOffset),{top:o,left:i}},i}(),i.prototype.Defaults={selector:".rd-parallax",screenAliases:{0:"-",480:"-xs-",768:"-sm-",992:"-md-",1200:"-lg-",1920:"-xl-",2560:"-xxl-"}},i.prototype.initialize=function(){var i,o,s,r,a,l,p,h;for(i=this,s=t.querySelectorAll(i.options.selector),h=n.innerWidth,p=n.innerHeight,r=a=0,l=s.length;a<l;r=++a)o=s[r],i.scenes.push(new d(o,i.options.screenAliases,h,p));e(n).on("resize",e.proxy(i.resize,i)),f&&e("input").on("focusin focus",function(t){return t.preventDefault(),i.activeOffset=e(this).offset().top,n.scrollTo(n.scrollX||n.pageXOffset,i.activeOffset-this.offsetHeight-100)}),e(n).trigger("resize"),i.update(),i.checkResize()},i.prototype.resize=function(e){var i,o,s,r,a,f;if(i=this,(o=n.innerWidth)!==i.windowWidth||!l||e){for(i.windowWidth=o,i.windowHeight=n.innerHeight,i.documentHeight=t.body.offsetHeight,a=i.scenes,s=0,r=a.length;s<r;s++)f=a[s],f.refresh(i.windowWidth,i.windowHeight);return i.update(!0)}},i.prototype.update=function(e){var i,o,r,a,p,h,u,d,g,c,m,y;if(o=this,e||requestAnimationFrame(function(){o.update()}),c=n.scrollY||n.pageYOffset,f&&null!=(i=t.activeElement)&&(i.tagName.match(/(input)|(select)|(textarea)/i)?(o.activeElement=i,o.inputFocus=!0):(o.activeElement=null,o.inputFocus=!1,e=!0)),l&&s&&(r=n.innerHeight-o.windowHeight,o.deltaHeight=r,c-=o.deltaHeight),(c!==o.lastScrollY||e)&&!o.isActing){for(o.isActing=!0,y=o.windowWidth,m=o.windowHeight,p=o.documentHeight,a=c-o.lastScrollY,f&&null!=o.activeElement&&(o.activeElement.value=o.activeElement.value+" ",o.activeElement.value=o.activeElement.value.trim()),d=o.scenes,h=0,u=d.length;h<u;h++)g=d[h],(o.inputFocus||e||c+m>=(g.agentOffset||g.offsetTop)+a&&c<=(g.agentOffset||g.offsetTop)+(g.agentHeight||g.offsetHeight)+a)&&g.update(c,y,m,p,o.inputFocus);return o.lastScrollY=c,o.isActing=!1}},i.prototype.checkResize=function(){var e;e=this,setInterval(function(){var n,i,o,s,r,a,l,f,p;for(n=t.body.offsetHeight,l=e.scenes,i=0,r=l.length;i<r;i++){for(p=l[i],f=p.layers,o=0,a=f.length;o<a;o++)if(s=f[o],s.isHolderWrong()){e.checkLayerHeight=!0;break}if(e.checkLayerHeight)break}if(e.checkLayerHeight||n!==e.lastDocHeight)return e.resize(!0),e.lastDocHeight=n,e.checkLayerHeight=!1},500)},i}(),e.RDParallax=function(n){var o;if(o=e(t),!o.data("RDParallax"))return o.data("RDParallax",new i(n))},n.RDParallax=i}(window.jQuery,document,window),"undefined"!=typeof module&&null!==module?module.exports=window.RDParallax:"function"==typeof define&&define.amd&&define(["jquery"],function(){"use strict";return window.RDParallax})}).call(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJkLXBhcmFsbGF4LmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsIndpbmRvdyIsIlJEUGFyYWxsYXgiLCJoYXNDbGFzc0xpc3QiLCJpc0Nocm9tZSIsImlzQ2hyb21lSU9TIiwiaXNJRSIsImlzTW9iaWxlIiwiaXNTYWZhcmlJT1MiLCJpc1dlYmtpdCIsImlzV2luOCIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ2ZW5kb3IiLCJtYXRjaCIsImFwcFZlcnNpb24iLCJpbmRleE9mIiwidG9Mb3dlckNhc2UiLCJib2R5IiwiY2xhc3NMaXN0Iiwib3B0aW9ucyIsInRoaXMiLCJleHRlbmQiLCJEZWZhdWx0cyIsInNjZW5lcyIsImluaXRpYWxpemUiLCJzY3JvbGxZIiwicGFnZVlPZmZzZXQiLCJsYXN0U2Nyb2xsWSIsImxhc3REb2NIZWlnaHQiLCJpbnB1dEZvY3VzIiwiY2hlY2tMYXllckhlaWdodCIsIkxheWVyIiwiU2NlbmUiLCJlbGVtZW50IiwiYWxpYXNlcyIsIndpbmRvd1dpZHRoIiwid2luZG93SGVpZ2h0Iiwic2NlbmVPZmZzZXQiLCJzY2VuZUhlaWdodCIsInNjZW5lT24iLCJhbWVuZCIsInR5cGUiLCJnZXRBdHRyaWJ1dGUiLCJob2xkZXIiLCJjcmVhdGVIb2xkZXIiLCJkaXJlY3Rpb24iLCJmYWRlIiwiYmx1ciIsImJvdW5kVG8iLCJxdWVyeVNlbGVjdG9yIiwidXJsIiwicmVzcG9uc2l2ZSIsImdldFJlc3BvbnNpdmVPcHRpb25zIiwic3R5bGUiLCJyZWZyZXNoIiwicHJvdG90eXBlIiwibGF5ZXIiLCJzcGVlZCIsImdldE9wdGlvbiIsIm9mZnNldCIsIm9mZnNldEhlaWdodCIsImdldE1lZGlhSGVpZ2h0Iiwib2Zmc2V0V2lkdGgiLCJnZXRPZmZzZXQiLCJ0b3AiLCJjcmVhdGVFbGVtZW50IiwiYWRkIiwiY2xhc3NOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsImFwcGVuZENoaWxkIiwiaXNIb2xkZXJXcm9uZyIsImtleSIsInBvaW50IiwidGFyZ2V0UG9pbnQiLCJhbGlhcyIsImkiLCJqIiwiayIsImxlbiIsInJlZiIsInJlc29sdXRpb25zIiwidmFsdWUiLCJwdXNoIiwibGVuZ3RoIiwiZ2V0U3BlZWQiLCJwYXJzZUludCIsImZ1c2UiLCJsYXllckRldmlkZXIiLCJvZmZzZXRUb3AiLCJvcGFjaXR5IiwicG9zIiwic2NlbmVEZXZpZGVyIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9GaXhlZCIsIm1vdmUiLCJkb2N1bWVudEhlaWdodCIsImFnZW50T2Zmc2V0IiwiZHkiLCJoIiwidiIsImlzRmluaXRlIiwiTWF0aCIsIm1pbiIsIm1heCIsInBhcnNlRmxvYXQiLCJkaXJlY3Rpb25Nb2RpZmllciIsImFicyIsImJvdW5kIiwibGVmdCIsInNjcm9sbFgiLCJwYWdlWE9mZnNldCIsInNjZW5lIiwib24iLCJhZ2VudCIsImFuY2hvciIsImZpbmRBbmNob3IiLCJjYW52YXMiLCJjcmVhdGVDYW52YXMiLCJsYXllcnMiLCJjcmVhdGVMYXllcnMiLCJmaXRUbyIsImdldEZpdEVsZW1lbnQiLCJwYXJlbnQiLCJpc1RyYW5zZm9ybWVkIiwiY2FsbCIsImZpcnN0Q2hpbGQiLCJvZmZzZXRMZWZ0IiwiZWxlbWVudHMiLCJmaW5kIiwiZ2V0IiwicG9zaXRpb25Ub3AiLCJsIiwibGVuMSIsIm1lZGlhTGF5ZXJzIiwid2lkdGgiLCJhZ2VudEhlaWdodCIsInVwZGF0ZSIsInJlc3VsdHMiLCJlbCIsInQiLCJ0cmFuc2Zvcm1lZCIsInRyYW5zZm9ybXMiLCJ3ZWJraXRUcmFuc2Zvcm0iLCJPVHJhbnNmb3JtIiwibXNUcmFuc2Zvcm0iLCJNb3pUcmFuc2Zvcm0iLCJ0cmFuc2Zvcm0iLCJoYXNPd25Qcm9wZXJ0eSIsImdldENvbXB1dGVkU3R5bGUiLCJnZXRQcm9wZXJ0eVZhbHVlIiwic2VsZWN0b3IiLCJzY3JlZW5BbGlhc2VzIiwiMCIsIjQ4MCIsIjc2OCIsIjk5MiIsIjEyMDAiLCIxOTIwIiwiMjU2MCIsImN0eCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJwcm94eSIsInJlc2l6ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFjdGl2ZU9mZnNldCIsInNjcm9sbFRvIiwidHJpZ2dlciIsImNoZWNrUmVzaXplIiwiZm9yY2VSZXNpemUiLCJjdXJyZW50V2luZG93V2lkdGgiLCJmb3JjZVVwZGF0ZSIsImFjdGl2ZUVsZW1lbnQiLCJkZWx0YUhlaWdodCIsImRlbHRhU2Nyb2xsIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidGFnTmFtZSIsImlzQWN0aW5nIiwidHJpbSIsInNldEludGVydmFsIiwiZG9jSGVpZ2h0IiwicmVmMSIsIiRkb2MiLCJkYXRhIiwialF1ZXJ5IiwibW9kdWxlIiwiZXhwb3J0cyIsImRlZmluZSIsImFtZCJdLCJtYXBwaW5ncyI6IkNBR0EsWUFDSSxTQUFVQSxFQUFHQyxFQUFVQyxHQUtuQixHQUFJQyxHQUFZQyxFQUFjQyxFQUFVQyxFQUFhQyxFQUFNQyxFQUFVQyxFQUFhQyxFQUFVQyxDQSs0QjVGLE9BOTRCQUgsR0FBVyxpRUFBaUVJLEtBQUtDLFVBQVVDLFdBQzNGVCxFQUFXLFNBQVNPLEtBQUtDLFVBQVVDLFdBQ25DSixFQUFZLFNBQVNFLEtBQUtDLFVBQVVDLFlBQWMsYUFBYUYsS0FBS0MsVUFBVUUsU0FBYSxTQUFTSCxLQUFLQyxVQUFVQyxZQUFjLGlCQUFpQkYsS0FBS0MsVUFBVUUsUUFDaktULEVBQWNFLEdBQVksU0FBU0ksS0FBS0MsVUFBVUMsV0FDbERMLEVBQWMsb0JBQW9CRyxLQUFLQyxVQUFVQyxjQUFnQkQsVUFBVUMsVUFBVUUsTUFBTSw0QkFDM0ZULEVBQU9NLFVBQVVJLFdBQVdDLFFBQVEsV0FBWSxHQUFNTCxVQUFVSSxXQUFXQyxRQUFRLGFBQWMsRUFDakdQLEVBQVMsaUJBQWlCQyxLQUFLQyxVQUFVQyxVQUFVSyxnQkFBa0IsaUJBQWlCUCxLQUFLQyxVQUFVQyxVQUFVSyxlQUMvR2YsRUFBMEMsTUFBM0JILEVBQVNtQixLQUFLQyxV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LGtCQUFtQixDQUN2QixPQUdSLEdBQUlrSSxFQUFJbEksaUJBQ0osTUFHUixHQUFJa0ksRUFBSWxJLGtCQUFvQnlKLElBQWN2QixFQUFJcEksY0FHMUMsTUFGQW9JLEdBQUlLLFFBQU8sR0FDWEwsRUFBSXBJLGNBQWdCMkosRUFDYnZCLEVBQUlsSSxrQkFBbUIsR0FFbkMsTUFHQTlCLEtBUVhILEVBQUVHLFdBQWEsU0FBU21CLEdBQ3BCLEdBQUlzSyxFQUVKLElBREFBLEVBQU81TCxFQUFFQyxJQUNKMkwsRUFBS0MsS0FBSyxjQUNYLE1BQU9ELEdBQUtDLEtBQUssYUFBYyxHQUFJMUwsR0FBV21CLEtBRy9DcEIsRUFBT0MsV0FBYUEsR0FDNUJELE9BQU80TCxPQUFRN0wsU0FBVUMsUUFRTixtQkFBWDZMLFNBQXFDLE9BQVhBLE9BQ2pDQSxPQUFPQyxRQUFVOUwsT0FBT0MsV0FDQyxrQkFBWDhMLFNBQXlCQSxPQUFPQyxLQUM5Q0QsUUFBUSxVQUFXLFdBQ2YsWUFDQSxPQUFPL0wsUUFBT0MsZUFJdkI2SCxLQUFLekciLCJmaWxlIjoicmQtcGFyYWxsYXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBEZWxsIG9uIDE1LjA4LjIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAoZnVuY3Rpb24oJCwgZG9jdW1lbnQsIHdpbmRvdykge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb21wYXRpYmlsaXR5IGZsYWdzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIFJEUGFyYWxsYXgsIGhhc0NsYXNzTGlzdCwgaXNDaHJvbWUsIGlzQ2hyb21lSU9TLCBpc0lFLCBpc01vYmlsZSwgaXNTYWZhcmlJT1MsIGlzV2Via2l0LCBpc1dpbjg7XHJcbiAgICAgICAgaXNNb2JpbGUgPSAvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbiAgICAgICAgaXNDaHJvbWUgPSAvQ2hyb21lLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgICAgIGlzV2Via2l0ID0gKC9DaHJvbWUvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgJiYgL0dvb2dsZSBJbmMvLnRlc3QobmF2aWdhdG9yLnZlbmRvcikpIHx8ICgvU2FmYXJpLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmIC9BcHBsZSBDb21wdXRlci8udGVzdChuYXZpZ2F0b3IudmVuZG9yKSk7XHJcbiAgICAgICAgaXNDaHJvbWVJT1MgPSBpc01vYmlsZSAmJiAvY3Jpb3MvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgICAgIGlzU2FmYXJpSU9TID0gL2lQaG9uZXxpUGFkfGlQb2QvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmICEhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvVmVyc2lvblxcL1tcXGRcXC5dKy4qU2FmYXJpLyk7XHJcbiAgICAgICAgaXNJRSA9IG5hdmlnYXRvci5hcHBWZXJzaW9uLmluZGV4T2YoXCJNU0lFXCIpICE9PSAtMSB8fCBuYXZpZ2F0b3IuYXBwVmVyc2lvbi5pbmRleE9mKCdUcmlkZW50LycpID4gLTE7XHJcbiAgICAgICAgaXNXaW44ID0gL3dpbmRvd3MgbnQgNi4yLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSkgfHwgL3dpbmRvd3MgbnQgNi4zLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgaGFzQ2xhc3NMaXN0ID0gZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QgIT0gbnVsbDtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHJlcXVlc3RBbmltYXRpb25GcmFtZSBwb2x5ZmlsbFxyXG4gICAgICAgICAqIGh0dHA6Ly9wYXVsaXJpc2guY29tLzIwMTEvcmVxdWVzdGFuaW1hdGlvbmZyYW1lLWZvci1zbWFydC1hbmltYXRpbmcvXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgaywgbGFzdFRpbWUsIGxlbiwgdmVuZG9yLCB2ZW5kb3JzO1xyXG4gICAgICAgICAgICBsYXN0VGltZSA9IDA7XHJcbiAgICAgICAgICAgIHZlbmRvcnMgPSBbJ21zJywgJ21veicsICd3ZWJraXQnLCAnbyddO1xyXG4gICAgICAgICAgICBmb3IgKGsgPSAwLCBsZW4gPSB2ZW5kb3JzLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICB2ZW5kb3IgPSB2ZW5kb3JzW2tdO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t2ZW5kb3IgKyBcIlJlcXVlc3RBbmltYXRpb25GcmFtZVwiXTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t2ZW5kb3IgKyBcIkNhbmNlbEFuaW1hdGlvbkZyYW1lXCJdIHx8IHdpbmRvd1t2ZW5kb3IgKyBcIkNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZVwiXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbihjYWxsYmFjaywgZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyVGltZSwgaWQsIHRpbWVUb0NhbGw7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VyclRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aW1lVG9DYWxsID0gTWF0aC5tYXgoMCwgMTYgLSAoY3VyclRpbWUgLSBsYXN0VGltZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlkID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGN1cnJUaW1lICsgdGltZVRvQ2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdGltZVRvQ2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdFRpbWUgPSBjdXJyVGltZSArIHRpbWVUb0NhbGw7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChpZCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENyZWF0ZXMgYSBwYXJhbGxheC5cclxuICAgICAgICAgKiBAY2xhc3MgUkRQYXJhbGxheC5cclxuICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCAtIFRoZSBlbGVtZW50IHRvIGNyZWF0ZSB0aGUgcGFyYWxsYXggZm9yLlxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSBUaGUgb3B0aW9uc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIFJEUGFyYWxsYXggPSAoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQ3JlYXRlcyBhIHBhcmFsbGF4IGxheWVyLlxyXG4gICAgICAgICAgICAgKiBAY2xhc3MgTGF5ZXIuXHJcbiAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCAtIFRoZSBlbGVtZW50IHRvIGNyZWF0ZSBhIGxheWVyIGZvci5cclxuICAgICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGFsaWFzZXMgLSBBbiBvYmplY3Qgd2l0aCB3aWR0aCBicmVha3BvaW50cyBhbGlhc2VzXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVlcn0gd2luZG93V2lkdGggLSBjdXJyZW50IHdpbmRvdyB3aWR0aFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdmFyIExheWVyLCBTY2VuZTtcclxuXHJcbiAgICAgICAgICAgIExheWVyID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gTGF5ZXIoZWxlbWVudCwgYWxpYXNlcywgd2luZG93V2lkdGgsIHdpbmRvd0hlaWdodCwgc2NlbmVPZmZzZXQsIHNjZW5lSGVpZ2h0LCBzY2VuZU9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbWVuZCA9IGlzV2Via2l0IHx8IGlzSUUgfHwgaXNNb2JpbGUgPyA2MCA6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFsaWFzZXMgPSBhbGlhc2VzO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10eXBlXCIpIHx8IFwiaHRtbFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09IFwiaHRtbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaG9sZGVyID0gdGhpcy5jcmVhdGVIb2xkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtZGlyZWN0aW9uXCIpID09PSBcIm5vcm1hbFwiIHx8IChlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtZGlyZWN0aW9uXCIpID09IG51bGwpID8gMSA6IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFkZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1mYWRlXCIpID09PSBcInRydWVcIjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJsdXIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtYmx1clwiKSA9PT0gXCJ0cnVlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3VuZFRvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtYm91bmQtdG9cIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09IFwibWVkaWFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVybCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS11cmxcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2l2ZSA9IHRoaXMuZ2V0UmVzcG9uc2l2ZU9wdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKCFpc0lFICYmICFpc01vYmlsZSkgfHwgaXNNb2JpbGUgfHwgKGlzV2luOCAmJiBpc0lFKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbXCJwb3NpdGlvblwiXSA9IFwiYWJzb2x1dGVcIjtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbXCJwb3NpdGlvblwiXSA9IFwiZml4ZWRcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm1lZGlhXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51cmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtcImJhY2tncm91bmQtaW1hZ2VcIl0gPSBcInVybChcIiArIHRoaXMudXJsICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImh0bWxcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0lFICYmIGlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW1wiei1pbmRleFwiXSA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCh3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBzY2VuZU9mZnNldCwgc2NlbmVIZWlnaHQsIHNjZW5lT24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBSZWZyZXNoIGxheWVyIHNpemUgc3RhdGVtZW50c1xyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpbmRvdyB3aWR0aFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgTGF5ZXIucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbih3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBzY2VuZU9mZnNldCwgc2NlbmVIZWlnaHQsIHNjZW5lT24pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIGxheWVyLnNwZWVkID0gbGF5ZXIuZ2V0T3B0aW9uKFwic3BlZWRcIiwgd2luZG93V2lkdGgpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIub2Zmc2V0ID0gbGF5ZXIuZ2V0T3B0aW9uKFwib2Zmc2V0XCIsIHdpbmRvd1dpZHRoKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNNb2JpbGUgJiYgIShpc1dpbjggJiYgaXNJRSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjZW5lT24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCJwb3NpdGlvblwiXSA9IFwiZml4ZWRcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCJwb3NpdGlvblwiXSA9IFwiYWJzb2x1dGVcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJRSAmJiBsYXllci50eXBlID09PSBcImh0bWxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllci5lbGVtZW50LnN0eWxlW1wicG9zaXRpb25cIl0gPSBcImFic29sdXRlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobGF5ZXIudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibWVkaWFcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNJRSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLm9mZnNldEhlaWdodCA9IGxheWVyLmdldE1lZGlhSGVpZ2h0KHdpbmRvd0hlaWdodCwgc2NlbmVIZWlnaHQsIGxheWVyLnNwZWVkLCBsYXllci5kaXJlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsYXllci5lbGVtZW50LnN0eWxlW1wiaGVpZ2h0XCJdID0gbGF5ZXIub2Zmc2V0SGVpZ2h0ICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJodG1sXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllci5lbGVtZW50LnN0eWxlW1wid2lkdGhcIl0gPSB0aGlzLmhvbGRlci5vZmZzZXRXaWR0aCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLm9mZnNldEhlaWdodCA9IGxheWVyLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXIuaG9sZGVyLnN0eWxlW1wiaGVpZ2h0XCJdID0gbGF5ZXIub2Zmc2V0SGVpZ2h0ICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCghaXNJRSAmJiAhaXNNb2JpbGUpIHx8IGlzTW9iaWxlIHx8IChpc1dpbjggJiYgaXNJRSkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0lFKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCJwb3NpdGlvblwiXSA9IFwic3RhdGljXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzY2VuZU9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCJsZWZ0XCJdID0gKGxheWVyLmdldE9mZnNldChsYXllci5ob2xkZXIpLmxlZnQpICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllci5lbGVtZW50LnN0eWxlW1widG9wXCJdID0gKGxheWVyLmdldE9mZnNldChsYXllci5ob2xkZXIpLnRvcCAtIHNjZW5lT2Zmc2V0KSArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxheWVyLmhvbGRlci5zdHlsZVtcInBvc2l0aW9uXCJdID0gXCJzdGF0aWNcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3VzdG9tXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGF5ZXIub2Zmc2V0SGVpZ2h0ID0gbGF5ZXIuZWxlbWVudC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBDcmVhdGVzIGEgc3RhdGljIGxheWVyIGhvbGRlciBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7ZWxlbWVudH0gaG9sZGVyXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBMYXllci5wcm90b3R5cGUuY3JlYXRlSG9sZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvbGRlciwgbGF5ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIGhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBob2xkZXIuY2xhc3NMaXN0LmFkZChcInJkLXBhcmFsbGF4LWxheWVyLWhvbGRlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBob2xkZXIuY2xhc3NOYW1lID0gXCJyZC1wYXJhbGxheC1sYXllci1ob2xkZXJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShob2xkZXIsIGxheWVyLmVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhvbGRlci5hcHBlbmRDaGlsZChsYXllci5lbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKCFpc0lFICYmICFpc01vYmlsZSkgfHwgaXNDaHJvbWVJT1MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyLnN0eWxlW1wicG9zaXRpb25cIl0gPSBcInJlbGF0aXZlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBob2xkZXI7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIENyZWF0ZXMgYSBzdGF0aWMgbGF5ZXIgaG9sZGVyIGVsZW1lbnRcclxuICAgICAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtlbGVtZW50fSBob2xkZXJcclxuICAgICAgICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgICAgIExheWVyLnByb3RvdHlwZS5pc0hvbGRlcldyb25nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxheWVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGxheWVyID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGF5ZXIudHlwZSA9PT0gXCJodG1sXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxheWVyLmhvbGRlci5vZmZzZXRIZWlnaHQgIT09IGxheWVyLmVsZW1lbnQub2Zmc2V0SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIEdldHMgc3BlY2lmaWMgb3B0aW9uIG9mIGxheWVyXHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5XHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gd2luZG93IHdpZHRoXHJcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgTGF5ZXIucHJvdG90eXBlLmdldE9wdGlvbiA9IGZ1bmN0aW9uKGtleSwgd2luZG93V2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5ZXIsIHBvaW50LCB0YXJnZXRQb2ludDtcclxuICAgICAgICAgICAgICAgICAgICBsYXllciA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChwb2ludCBpbiBsYXllci5yZXNwb25zaXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2ludCA8PSB3aW5kb3dXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnQgPSBwb2ludDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGF5ZXIucmVzcG9uc2l2ZVt0YXJnZXRQb2ludF1ba2V5XTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogQ3JlYXRlcyBhIHNldCBvZiByZXNwb25zaXZlIG9wdGlvbnMgb2YgdGhlIGxheWVyXHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSBvcHRpb25zXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBMYXllci5wcm90b3R5cGUuZ2V0UmVzcG9uc2l2ZU9wdGlvbnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWxpYXMsIGFsaWFzZXMsIGksIGosIGssIGxlbiwgcG9pbnQsIHJlZiwgcmVzb2x1dGlvbnMsIHJlc3BvbnNpdmUsIHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNpdmUgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHV0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsaWFzZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICByZWYgPSB0aGlzLmFsaWFzZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpIGluIHJlZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IHJlZltpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x1dGlvbnMucHVzaChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXNlcy5wdXNoKGFsaWFzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gayA9IDAsIGxlbiA9IHJlc29sdXRpb25zLmxlbmd0aDsgayA8IGxlbjsgaSA9ICsraykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludCA9IHJlc29sdXRpb25zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlW3BvaW50XSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKGogPSBpKSA+PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zaXZlW3BvaW50XVtcInNwZWVkXCJdICYmICh2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIgKyBhbGlhc2VzW2pdICsgXCJzcGVlZFwiKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlW3BvaW50XVtcInNwZWVkXCJdID0gdGhpcy5nZXRTcGVlZCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNpdmVbcG9pbnRdW1wib2Zmc2V0XCJdICYmICh2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIgKyBhbGlhc2VzW2pdICsgXCJvZmZzZXRcIikpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2l2ZVtwb2ludF1bXCJvZmZzZXRcIl0gPSBwYXJzZUludCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNpdmVbcG9pbnRdW1wiZmFkZVwiXSAmJiAodmFsdWUgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YVwiICsgYWxpYXNlc1tqXSArIFwiZmFkZVwiKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlW3BvaW50XVtcImZhZGVcIl0gPSB2YWx1ZSA9PT0gJ3RydWUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zaXZlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBGYWRlIGxheWVyIGFjY29yZGluZyB0byBpdHMgcG9zaXRpb24gaW4gc2NlbmVcclxuICAgICAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY2VuZU9mZnNldCAtIGN1cnJlbnQgc2NlbmUgb2Zmc2V0XHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gc2NlbmVIZWlnaHQgLSBjdXJyZW50IHNjZW5lIGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgTGF5ZXIucHJvdG90eXBlLmZ1c2UgPSBmdW5jdGlvbihzY2VuZU9mZnNldCwgc2NlbmVIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5ZXIsIGxheWVyRGV2aWRlciwgb2Zmc2V0VG9wLCBvcGFjaXR5LCBwb3MsIHNjZW5lRGV2aWRlcjtcclxuICAgICAgICAgICAgICAgICAgICBsYXllciA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0VG9wID0gbGF5ZXIuZ2V0T2Zmc2V0KGxheWVyLmVsZW1lbnQpLnRvcCArIGxheWVyLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lRGV2aWRlciA9IHNjZW5lT2Zmc2V0ICsgc2NlbmVIZWlnaHQgLyAyLjA7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJEZXZpZGVyID0gb2Zmc2V0VG9wICsgbGF5ZXIub2Zmc2V0SGVpZ2h0IC8gMi4wO1xyXG4gICAgICAgICAgICAgICAgICAgIHBvcyA9IHNjZW5lSGVpZ2h0IC8gNi4wO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY2VuZURldmlkZXIgKyBwb3MgPiBsYXllckRldmlkZXIgJiYgc2NlbmVEZXZpZGVyIC0gcG9zIDwgbGF5ZXJEZXZpZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCJvcGFjaXR5XCJdID0gMTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NlbmVEZXZpZGVyIC0gcG9zIDwgbGF5ZXJEZXZpZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5ID0gMSArICgoc2NlbmVEZXZpZGVyICsgcG9zIC0gbGF5ZXJEZXZpZGVyKSAvIHNjZW5lSGVpZ2h0IC8gMy4wICogMTApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eSA9IDEgLSAoKHNjZW5lRGV2aWRlciAtIHBvcyAtIGxheWVyRGV2aWRlcikgLyBzY2VuZUhlaWdodCAvIDMuMCAqIDEwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllci5lbGVtZW50LnN0eWxlW1wib3BhY2l0eVwiXSA9IG9wYWNpdHkgPCAwID8gMCA6IG9wYWNpdHkgPiAxID8gMSA6IG9wYWNpdHkudG9GaXhlZCgyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIE1vdmUgbGF5ZXIgaW4gc2NlbmVcclxuICAgICAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY3JvbGxZIC0gY3VycmVudCBzY3JvbGwgdG9wXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gd2luZG93V2lkdGggLSBjdXJyZW50IHdpbmRvdyB3aWR0aFxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpbmRvd0hlaWdodCAtIGN1cnJlbnQgd2luZG93IGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNjZW5lT2Zmc2V0IC0gY3VycmVudCBzY2VuZSBvZmZzZXQgdG9wXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gc2NlbmVIZWlnaHQgLSBjdXJyZW50IHNjZW5lIGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGRvY3VtZW50SGVpZ2h0IC0gY3VycmVudCBzY2VuZSBoZWlnaHRcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhZ2VudE9mZnNldCAtIGN1cnJlbnQgYWdlbnQgb2Zmc2V0XHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBMYXllci5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKHNjcm9sbFksIHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQsIHNjZW5lT2Zmc2V0LCBzY2VuZUhlaWdodCwgZG9jdW1lbnRIZWlnaHQsIHNjZW5lT24sIGFnZW50T2Zmc2V0LCBpbnB1dEZvY3VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGR5LCBoLCBsYXllciwgcG9zLCB2O1xyXG4gICAgICAgICAgICAgICAgICAgIGxheWVyID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJRSAmJiBsYXllci50eXBlID09PSBcIm1lZGlhXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNNb2JpbGUgfHwgKGlzV2luOCAmJiBpc0lFKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2NlbmVPbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNXZWJraXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCItd2Via2l0LXRyYW5zZm9ybVwiXSA9IFwidHJhbnNsYXRlM2QoMCwwLDApXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXIuZWxlbWVudC5zdHlsZVtcInRyYW5zZm9ybVwiXSA9IFwidHJhbnNsYXRlM2QoMCwwLDApXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCghaXNNb2JpbGUpIHx8IChsYXllci50eXBlID09PSBcImh0bWxcIiAmJiBpbnB1dEZvY3VzKSB8fCBpc0Nocm9tZUlPUykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2ID0gbGF5ZXIuc3BlZWQgKiBsYXllci5kaXJlY3Rpb247XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdiA9IGxheWVyLnNwZWVkICogbGF5ZXIuZGlyZWN0aW9uIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaCA9IGxheWVyLm9mZnNldEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWdlbnRPZmZzZXQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkeSA9IChzY2VuZU9mZnNldCArIHdpbmRvd0hlaWdodCAtIChhZ2VudE9mZnNldCArIHdpbmRvd0hlaWdodCkpIC8gKHdpbmRvd0hlaWdodCAtIHNjZW5lSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxheWVyLnR5cGUgIT09IFwibWVkaWFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NlbmVPZmZzZXQgPCB3aW5kb3dIZWlnaHQgfHwgc2NlbmVPZmZzZXQgPiBkb2N1bWVudEhlaWdodCAtIHdpbmRvd0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjZW5lT2Zmc2V0IDwgd2luZG93SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHkgPSBzY2VuZU9mZnNldCAvICh3aW5kb3dIZWlnaHQgLSBzY2VuZUhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR5ID0gKHNjZW5lT2Zmc2V0ICsgd2luZG93SGVpZ2h0IC0gZG9jdW1lbnRIZWlnaHQpIC8gKHdpbmRvd0hlaWdodCAtIHNjZW5lSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNGaW5pdGUoZHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHkgPSAwLjU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkeSA9IDAuNTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2hyb21lSU9TIHx8IGlzSUUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gKHNjZW5lSGVpZ2h0IC0gaCkgLyAyICsgKHdpbmRvd0hlaWdodCAtIHNjZW5lSGVpZ2h0KSAqIGR5ICogdiArIGxheWVyLm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IC0oc2NlbmVPZmZzZXQgLSBzY3JvbGxZKSAqIHYgKyAoc2NlbmVIZWlnaHQgLSBoKSAvIDIgKyAod2luZG93SGVpZ2h0IC0gc2NlbmVIZWlnaHQpICogZHkgKiAodiArIDEpICsgbGF5ZXIub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IC0oc2NlbmVPZmZzZXQgLSBzY3JvbGxZKSAqIHYgKyAoc2NlbmVIZWlnaHQgLSBoKSAvIDIgKyAod2luZG93SGVpZ2h0IC0gc2NlbmVIZWlnaHQpICogZHkgKiB2ICsgbGF5ZXIub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNNb2JpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnZW50T2Zmc2V0ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmVsZW1lbnQuc3R5bGVbXCJ0b3BcIl0gPSAoc2NlbmVPZmZzZXQgLSBhZ2VudE9mZnNldCkgKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzV2Via2l0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtcIi13ZWJraXQtdHJhbnNmb3JtXCJdID0gXCJ0cmFuc2xhdGUzZCgwLFwiICsgcG9zICsgXCJweCwwKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbXCJ0cmFuc2Zvcm1cIl0gPSBcInRyYW5zbGF0ZTNkKDAsXCIgKyBwb3MgKyBcInB4LDApXCI7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIE5vcm1hbGl6ZSBsYXllciBzcGVlZFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIC0gc3BlZWRcclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IG5vcm1hbGl6ZWQgc3BlZWRcclxuICAgICAgICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgICAgIExheWVyLnByb3RvdHlwZS5nZXRTcGVlZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHBhcnNlRmxvYXQodmFsdWUpLCAwKSwgMi4wKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogQ2FsY3VsYXRlIG1lZGlhIGxheWVyIGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpbmRvd0hlaWdodCAtIGN1cnJlbnQgd2luZG93IGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNjZW5lSGVpZ2h0IC0gY3VycmVudCBzY2VuZSBoZWlnaHRcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzcGVlZCAtIGN1cnJlbnQgc3BlZWRcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJlY3Rpb24gLSBtb3ZlbWVudCBkaXJlY3Rpb25cclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IG1lZGlhIGxheWVyIGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgTGF5ZXIucHJvdG90eXBlLmdldE1lZGlhSGVpZ2h0ID0gZnVuY3Rpb24od2luZG93SGVpZ2h0LCBzY2VuZUhlaWdodCwgc3BlZWQsIGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb25Nb2RpZmllcjtcclxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb25Nb2RpZmllciA9IGRpcmVjdGlvbiA9PT0gLTEgPyAoc2NlbmVIZWlnaHQgKyB3aW5kb3dIZWlnaHQpICogc3BlZWQgOiAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoc2NlbmVIZWlnaHQgKyBkaXJlY3Rpb25Nb2RpZmllciArIChzcGVlZCA8PSAxID8gTWF0aC5hYnMod2luZG93SGVpZ2h0IC0gc2NlbmVIZWlnaHQpICogc3BlZWQgOiB3aW5kb3dIZWlnaHQgKiBzcGVlZCkpICsgdGhpcy5hbWVuZCAqIDI7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIENhbGMgdGhlIGVsZW1lbnQgb2Zmc2V0IHJlbGF0aXZlIHRvIGRvY3VtZW50LiBNZXRob2QgaXMgc2ltaWxhciB0byAkLm9mZnNldCgpXHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge2VsZW1lbnR9IGVsZW1lbnQgLSBIVE1MIEVsZW1lbnRcclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtvYmplY3R9IHRvcCBhbmQgbGVmdCBvZmZzZXRzXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBMYXllci5wcm90b3R5cGUuZ2V0T2Zmc2V0ID0gZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBib3VuZCwgbGVmdCwgdG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIGJvdW5kID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gYm91bmQubGVmdCArICh3aW5kb3cuc2Nyb2xsWCB8fCB3aW5kb3cucGFnZVhPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IGJvdW5kLnRvcCArICh3aW5kb3cuc2Nyb2xsWSB8fCB3aW5kb3cucGFnZVlPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdG9wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIExheWVyO1xyXG5cclxuICAgICAgICAgICAgfSkoKTtcclxuXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQ3JlYXRlcyBhIHBhcmFsbGF4IHNjZW5lLlxyXG4gICAgICAgICAgICAgKiBAY2xhc3MgU2NlbmUuXHJcbiAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCAtIFRoZSBlbGVtZW50IHRvIGNyZWF0ZSBhIHNjZW5lIGZvci5cclxuICAgICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGFsaWFzZXMgLSBBbiBvYmplY3Qgd2l0aCB3aWR0aCBicmVha3BvaW50cyBhbGlhc2VzXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7bnVtYmVlcn0gd2luZG93V2lkdGggLSBjdXJyZW50IHdpbmRvdyB3aWR0aFxyXG4gICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgIFNjZW5lID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gU2NlbmUoZWxlbWVudCwgYWxpYXNlcywgd2luZG93V2lkdGgsIHdpbmRvd0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2VuZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUuYW1lbmQgPSBpc1dlYmtpdCA/IDYwIDogMDtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5hbGlhc2VzID0gYWxpYXNlcztcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5vbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUuYWdlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hZ2VudFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUuYW5jaG9yID0gc2NlbmUuZmluZEFuY2hvcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLmNhbnZhcyA9IHNjZW5lLmNyZWF0ZUNhbnZhcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLmxheWVycyA9IHNjZW5lLmNyZWF0ZUxheWVycyh3aW5kb3dXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUuZml0VG8gPSBzY2VuZS5nZXRGaXRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUucmVzcG9uc2l2ZSA9IHNjZW5lLmdldFJlc3BvbnNpdmVPcHRpb25zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUucmVmcmVzaCh3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBGaW5kcyBhbiBlbGVtZW50IHRoYXQgbGF5ZXIgd2lsbCBmaXQgdG9cclxuICAgICAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtlbGVtZW50fSBmaXQgZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLmdldEZpdEVsZW1lbnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZml0VG8sIHNjZW5lO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKGZpdFRvID0gc2NlbmUuZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWZpdC10b1wiKSkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZml0VG8gPT09IFwicGFyZW50XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY2VuZS5lbGVtZW50LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihmaXRUbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIENoZWNrcyBpZiBwYXJhbGxheCBzY2VuZSBpcyBpbnNpZGUgb2YgZWxlbWVudCB3aXRoIENTUyBUcmFuc2Zvcm1cclxuICAgICAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtlbGVtZW50fSBQYXJlbnQgZWxlbWVudCB3aXRoIENTUyBUcmFuc2Zvcm0gb3IgbnVsbFxyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLmZpbmRBbmNob3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50LCBzY2VuZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gc2NlbmUuZWxlbWVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICgocGFyZW50ICE9IG51bGwpICYmIHBhcmVudCAhPT0gZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjZW5lLmlzVHJhbnNmb3JtZWQuY2FsbChwYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogQ3JlYXRlcyBhIHBhcmFsbGF4IGNhbnZhcyBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7ZWxlbWVudH0gY2FudmFzXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBTY2VuZS5wcm90b3R5cGUuY3JlYXRlQ2FudmFzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcywgc2NlbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuY2xhc3NMaXN0LmFkZChcInJkLXBhcmFsbGF4LWlubmVyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5jbGFzc05hbWUgPSBcInJkLXBhcmFsbGF4LWlubmVyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLmVsZW1lbnQuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc2NlbmUuZWxlbWVudC5maXJzdENoaWxkICE9PSBjYW52YXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFwcGVuZENoaWxkKHNjZW5lLmVsZW1lbnQuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLmVsZW1lbnQuc3R5bGVbXCJwb3NpdGlvblwiXSA9IFwicmVsYXRpdmVcIjtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5lbGVtZW50LnN0eWxlW1wib3ZlcmZsb3dcIl0gPSBcImhpZGRlblwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNJRSAmJiAhaXNNb2JpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1wicG9zaXRpb25cIl0gPSBcImZpeGVkXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1wicG9zaXRpb25cIl0gPSBcImFic29sdXRlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGlzV2luOCAmJiBpc0lFKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1wiY2xpcFwiXSA9IFwicmVjdCgwLCBhdXRvLCBhdXRvLCAwKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0lFKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuc3R5bGVbXCJ0cmFuc2Zvcm1cIl0gPSBcInRyYW5zbGF0ZTNkKDAsMCwwKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1widHJhbnNmb3JtXCJdID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1wibGVmdFwiXSA9IHNjZW5lLm9mZnNldExlZnQgKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1widG9wXCJdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNXZWJraXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlW1wibWFyZ2luLXRvcFwiXSA9IFwiLVwiICsgc2NlbmUuYW1lbmQgKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5zdHlsZVtcInBhZGRpbmdcIl0gPSBzY2VuZS5hbWVuZCArIFwicHggMFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5lbGVtZW50LnN0eWxlW1wiei1pbmRleFwiXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYW52YXM7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIEdldHMgc3BlY2lmaWMgb3B0aW9uIG9mIGxheWVyXHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5XHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gd2luZG93IHdpZHRoXHJcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLmdldE9wdGlvbiA9IGZ1bmN0aW9uKGtleSwgd2luZG93V2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQsIHRhcmdldFBvaW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAocG9pbnQgaW4gdGhpcy5yZXNwb25zaXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2ludCA8PSB3aW5kb3dXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnQgPSBwb2ludDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNwb25zaXZlW3RhcmdldFBvaW50XVtrZXldO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBDcmVhdGVzIGEgc2V0IG9mIHJlc3BvbnNpdmUgb3B0aW9ucyBvZiB0aGUgbGF5ZXJcclxuICAgICAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtvYmplY3R9IG9wdGlvbnNcclxuICAgICAgICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgICAgIFNjZW5lLnByb3RvdHlwZS5nZXRSZXNwb25zaXZlT3B0aW9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGlhcywgYWxpYXNlcywgaSwgaiwgaywgbGVuLCBwb2ludCwgcmVmLCByZXNvbHV0aW9ucywgcmVzcG9uc2l2ZSwgdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2l2ZSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdXRpb25zID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgYWxpYXNlcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZiA9IHRoaXMuYWxpYXNlcztcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgaW4gcmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzID0gcmVmW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHV0aW9ucy5wdXNoKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlhc2VzLnB1c2goYWxpYXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBrID0gMCwgbGVuID0gcmVzb2x1dGlvbnMubGVuZ3RoOyBrIDwgbGVuOyBpID0gKytrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ID0gcmVzb2x1dGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNpdmVbcG9pbnRdID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoaiA9IGkpID49IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNpdmVbcG9pbnRdW1wib25cIl0gJiYgKCh2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIgKyBhbGlhc2VzW2pdICsgXCJvblwiKSkgIT0gbnVsbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlW3BvaW50XVtcIm9uXCJdID0gdmFsdWUgIT09IFwiZmFsc2VcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocmVzcG9uc2l2ZVtwb2ludF1bXCJvblwiXSA9PSBudWxsKSAmJiBqID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2l2ZVtwb2ludF1bXCJvblwiXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNpdmU7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIENyZWF0ZXMgdGhlIGxheWVycyBvZiBwYXJhbGxheFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpbmRvdyB3aWR0aFxyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge2FycmF5fSBMaXN0IG9mIGxheWVyc1xyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLmNyZWF0ZUxheWVycyA9IGZ1bmN0aW9uKHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCwgZWxlbWVudHMsIGksIGssIGxheWVycywgbGVuLCBzY2VuZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMgPSAkKHNjZW5lLmVsZW1lbnQpLmZpbmQoXCIucmQtcGFyYWxsYXgtbGF5ZXJcIikuZ2V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gayA9IDAsIGxlbiA9IGVsZW1lbnRzLmxlbmd0aDsgayA8IGxlbjsgaSA9ICsraykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVycy5wdXNoKG5ldyBMYXllcihlbGVtZW50LCBzY2VuZS5hbGlhc2VzLCB3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBzY2VuZS5vZmZzZXRUb3AsIHNjZW5lLm9mZnNldEhlaWdodCwgc2NlbmUub24pKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxheWVycztcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogVXBkYXRlIHNjZW5lIHBvc2l0aW9uXHJcbiAgICAgICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBTY2VuZS5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKHNjcm9sbFkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zLCBzY2VuZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjZW5lLmFuY2hvciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHNjZW5lLnBvc2l0aW9uVG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHNjZW5lLm9mZnNldFRvcCAtIHNjcm9sbFk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1dlYmtpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5jYW52YXMuc3R5bGVbXCItd2Via2l0LXRyYW5zZm9ybVwiXSA9IFwidHJhbnNsYXRlM2QoMCxcIiArIHBvcyArIFwicHgsMClcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmNhbnZhcy5zdHlsZVtcInRyYW5zZm9ybVwiXSA9IFwidHJhbnNsYXRlM2QoMCxcIiArIHBvcyArIFwicHgsMClcIjtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogUmVmcmVzaCBzY2VuZSBkaW1lbnNpb25zXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gd2luZG93V2lkdGggLSBjdXJyZW50IHdpbmRvdyB3aWR0aFxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpbmRvd0hlaWdodCAtIGN1cnJlbnQgd2luZG93IGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbih3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGssIGwsIGxheWVyLCBsZW4sIGxlbjEsIG1lZGlhTGF5ZXJzLCByZWYsIHNjZW5lO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYUxheWVycyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLm9uID0gc2NlbmUuZ2V0T3B0aW9uKFwib25cIiwgd2luZG93V2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLm9mZnNldFRvcCA9IHNjZW5lLmdldE9mZnNldChzY2VuZS5lbGVtZW50KS50b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUub2Zmc2V0TGVmdCA9IHNjZW5lLmdldE9mZnNldChzY2VuZS5lbGVtZW50KS5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIHNjZW5lLndpZHRoID0gc2NlbmUuZWxlbWVudC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5jYW52YXMuc3R5bGVbXCJ3aWR0aFwiXSA9IHNjZW5lLndpZHRoICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY2VuZS5hbmNob3IgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5wb3NpdGlvblRvcCA9IHNjZW5lLmVsZW1lbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NlbmUuYWdlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5hZ2VudE9mZnNldCA9IHNjZW5lLmdldE9mZnNldChzY2VuZS5hZ2VudCkudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5hZ2VudEhlaWdodCA9IHNjZW5lLmFnZW50Lm9mZnNldEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZS5hZ2VudE9mZnNldCA9IHNjZW5lLmFnZW50SGVpZ2h0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVmID0gc2NlbmUubGF5ZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGsgPCBsZW47IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllciA9IHJlZltrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxheWVyLnR5cGUgPT09IFwibWVkaWFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWFMYXllcnMucHVzaChsYXllcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllci5yZWZyZXNoKHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQsIHNjZW5lLm9mZnNldFRvcCwgc2NlbmUub2Zmc2V0SGVpZ2h0LCBzY2VuZS5vbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmUub2Zmc2V0SGVpZ2h0ID0gc2NlbmUuY2FudmFzLm9mZnNldEhlaWdodCAtIHNjZW5lLmFtZW5kICogMjtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZS5lbGVtZW50LnN0eWxlW1wiaGVpZ2h0XCJdID0gc2NlbmUub2Zmc2V0SGVpZ2h0ICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobCA9IDAsIGxlbjEgPSBtZWRpYUxheWVycy5sZW5ndGg7IGwgPCBsZW4xOyBsKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXIgPSBtZWRpYUxheWVyc1tsXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXIucmVmcmVzaCh3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBzY2VuZS5vZmZzZXRUb3AsIHNjZW5lLm9mZnNldEhlaWdodCwgc2NlbmUub24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogVXBkYXRlIHNjZW5lIGFjdFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKHNjcm9sbFksIHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQsIGRvY3VtZW50SGVpZ2h0LCBpbnB1dEZvY3VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGssIGxheWVyLCBsZW4sIHJlZiwgcmVzdWx0cywgc2NlbmUsIHNjZW5lSGVpZ2h0LCBzY2VuZU9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVPZmZzZXQgPSBzY2VuZS5vZmZzZXRUb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVIZWlnaHQgPSBzY2VuZS5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0lFICYmICghaXNNb2JpbGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLm1vdmUoc2Nyb2xsWSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlZiA9IHNjZW5lLmxheWVycztcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyID0gcmVmW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllci5tb3ZlKHNjcm9sbFksIHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQsIHNjZW5lT2Zmc2V0LCBzY2VuZUhlaWdodCwgZG9jdW1lbnRIZWlnaHQsIHNjZW5lLm9uLCBzY2VuZS5hZ2VudE9mZnNldCwgaW5wdXRGb2N1cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLmZhZGUgPSBsYXllci5nZXRPcHRpb24oXCJmYWRlXCIsIHdpbmRvd1dpZHRoKSB8fCBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxheWVyLmZhZGUgJiYgIWlzTW9iaWxlICYmICFpc0lFKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2gobGF5ZXIuZnVzZShzY2VuZU9mZnNldCwgc2NlbmVIZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh2b2lkIDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBDaGVja3MgaWYgZWxlbWVudCBpcyB0cmFuc2Zvcm1lZFxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBTY2VuZS5wcm90b3R5cGUuaXNUcmFuc2Zvcm1lZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbCwgdCwgdHJhbnNmb3JtZWQsIHRyYW5zZm9ybXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybXMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd3ZWJraXRUcmFuc2Zvcm0nOiAnLXdlYmtpdC10cmFuc2Zvcm0nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnT1RyYW5zZm9ybSc6ICctby10cmFuc2Zvcm0nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnbXNUcmFuc2Zvcm0nOiAnLW1zLXRyYW5zZm9ybScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdNb3pUcmFuc2Zvcm0nOiAnLW1vei10cmFuc2Zvcm0nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zZm9ybSdcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodCBpbiB0cmFuc2Zvcm1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmFuc2Zvcm1zLmhhc093blByb3BlcnR5KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwuc3R5bGVbdF0gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLmdldFByb3BlcnR5VmFsdWUodHJhbnNmb3Jtc1t0XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh0cmFuc2Zvcm1lZCAhPSBudWxsKSAmJiB0cmFuc2Zvcm1lZC5sZW5ndGggPiAwICYmIHRyYW5zZm9ybWVkICE9PSBcIm5vbmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBDYWxjIHRoZSBlbGVtZW50IG9mZnNldCByZWxhdGl2ZSB0byBkb2N1bWVudC4gTWV0aG9kIGlzIHNpbWlsYXIgdG8gJC5vZmZzZXQoKVxyXG4gICAgICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtlbGVtZW50fSBlbGVtZW50IC0gSFRNTCBFbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSB0b3AgYW5kIGxlZnQgb2Zmc2V0c1xyXG4gICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgU2NlbmUucHJvdG90eXBlLmdldE9mZnNldCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYm91bmQsIGxlZnQsIHRvcDtcclxuICAgICAgICAgICAgICAgICAgICBib3VuZCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IGJvdW5kLmxlZnQgKyAod2luZG93LnNjcm9sbFggfHwgd2luZG93LnBhZ2VZT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICB0b3AgPSBib3VuZC50b3AgKyAod2luZG93LnNjcm9sbFkgfHwgd2luZG93LnBhZ2VZT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogbGVmdFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBTY2VuZTtcclxuXHJcbiAgICAgICAgICAgIH0pKCk7XHJcblxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIERlZmF1bHQgb3B0aW9ucyBmb3IgcGFyYWxsYXguXHJcbiAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICBSRFBhcmFsbGF4LnByb3RvdHlwZS5EZWZhdWx0cyA9IHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnLnJkLXBhcmFsbGF4JyxcclxuICAgICAgICAgICAgICAgIHNjcmVlbkFsaWFzZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAwOiAnLScsXHJcbiAgICAgICAgICAgICAgICAgICAgNDgwOiAnLXhzLScsXHJcbiAgICAgICAgICAgICAgICAgICAgNzY4OiAnLXNtLScsXHJcbiAgICAgICAgICAgICAgICAgICAgOTkyOiAnLW1kLScsXHJcbiAgICAgICAgICAgICAgICAgICAgMTIwMDogJy1sZy0nLFxyXG4gICAgICAgICAgICAgICAgICAgIDE5MjA6ICcteGwtJyxcclxuICAgICAgICAgICAgICAgICAgICAyNTYwOiAnLXh4bC0nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBSRFBhcmFsbGF4KG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLkRlZmF1bHRzLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NlbmVzID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsWSA9IHdpbmRvdy5zY3JvbGxZIHx8IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFNjcm9sbFkgPSAtMTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdERvY0hlaWdodCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0Rm9jdXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tMYXllckhlaWdodCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEluaXRpYWxpemVzIHRoZSBQYXJhbGxheC5cclxuICAgICAgICAgICAgICogQHB1YmxpY1xyXG4gICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgIFJEUGFyYWxsYXgucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjdHgsIGVsZW1lbnQsIGVsZW1lbnRzLCBpLCBrLCBsZW4sIHdpbmRvd0hlaWdodCwgd2luZG93V2lkdGg7XHJcbiAgICAgICAgICAgICAgICBjdHggPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGN0eC5vcHRpb25zLnNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSBrID0gMCwgbGVuID0gZWxlbWVudHMubGVuZ3RoOyBrIDwgbGVuOyBpID0gKytrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5zY2VuZXMucHVzaChuZXcgU2NlbmUoZWxlbWVudCwgY3R4Lm9wdGlvbnMuc2NyZWVuQWxpYXNlcywgd2luZG93V2lkdGgsIHdpbmRvd0hlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJCh3aW5kb3cpLm9uKFwicmVzaXplXCIsICQucHJveHkoY3R4LnJlc2l6ZSwgY3R4KSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNTYWZhcmlJT1MpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dCcpLm9uKFwiZm9jdXNpbiBmb2N1c1wiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFjdGl2ZU9mZnNldCA9ICQodGhpcykub2Zmc2V0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93LnNjcm9sbFRvKHdpbmRvdy5zY3JvbGxYIHx8IHdpbmRvdy5wYWdlWE9mZnNldCwgY3R4LmFjdGl2ZU9mZnNldCAtIHRoaXMub2Zmc2V0SGVpZ2h0IC0gMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICQod2luZG93KS50cmlnZ2VyKFwicmVzaXplXCIpO1xyXG4gICAgICAgICAgICAgICAgY3R4LnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgY3R4LmNoZWNrUmVzaXplKCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFJlc2l6ZSBhbGwgc2NlbmVzXHJcbiAgICAgICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICBSRFBhcmFsbGF4LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbihmb3JjZVJlc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN0eCwgY3VycmVudFdpbmRvd1dpZHRoLCBrLCBsZW4sIHJlZiwgc2NlbmU7XHJcbiAgICAgICAgICAgICAgICBjdHggPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgaWYgKChjdXJyZW50V2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCkgIT09IGN0eC53aW5kb3dXaWR0aCB8fCAhaXNNb2JpbGUgfHwgZm9yY2VSZXNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHgud2luZG93V2lkdGggPSBjdXJyZW50V2luZG93V2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LndpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBjdHguZG9jdW1lbnRIZWlnaHQgPSBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICByZWYgPSBjdHguc2NlbmVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGsgPCBsZW47IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHJlZltrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUucmVmcmVzaChjdHgud2luZG93V2lkdGgsIGN0eC53aW5kb3dIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3R4LnVwZGF0ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVXBkYXRlIGFsbCBwYXJhbGxheCBzY2VuZXNcclxuICAgICAgICAgICAgICogQHBhcmFtIHtib29sZWFufSBmb3JjZVVwZGF0ZSAtIGZvcmNlIHNjZW5lcyB1cGRhdGUgaWYgc2Nyb2xsIHdhc250IHRyaWdnZXJlZFxyXG4gICAgICAgICAgICAgKiBAcHVibGljXHJcbiAgICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgUkRQYXJhbGxheC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oZm9yY2VVcGRhdGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmVFbGVtZW50LCBjdHgsIGRlbHRhSGVpZ2h0LCBkZWx0YVNjcm9sbCwgZG9jdW1lbnRIZWlnaHQsIGssIGxlbiwgcmVmLCBzY2VuZSwgc2Nyb2xsWSwgd2luZG93SGVpZ2h0LCB3aW5kb3dXaWR0aDtcclxuICAgICAgICAgICAgICAgIGN0eCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWZvcmNlVXBkYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxZID0gd2luZG93LnNjcm9sbFkgfHwgd2luZG93LnBhZ2VZT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzU2FmYXJpSU9TKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChhY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlRWxlbWVudC50YWdOYW1lLm1hdGNoKC8oaW5wdXQpfChzZWxlY3QpfCh0ZXh0YXJlYSkvaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hY3RpdmVFbGVtZW50ID0gYWN0aXZlRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5pbnB1dEZvY3VzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hY3RpdmVFbGVtZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5pbnB1dEZvY3VzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JjZVVwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNNb2JpbGUgJiYgaXNDaHJvbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWx0YUhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGN0eC53aW5kb3dIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmRlbHRhSGVpZ2h0ID0gZGVsdGFIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsWSAtPSBjdHguZGVsdGFIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoKChzY3JvbGxZICE9PSBjdHgubGFzdFNjcm9sbFkpIHx8IGZvcmNlVXBkYXRlKSAmJiAhY3R4LmlzQWN0aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmlzQWN0aW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dXaWR0aCA9IGN0eC53aW5kb3dXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dIZWlnaHQgPSBjdHgud2luZG93SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50SGVpZ2h0ID0gY3R4LmRvY3VtZW50SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhU2Nyb2xsID0gc2Nyb2xsWSAtIGN0eC5sYXN0U2Nyb2xsWTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTYWZhcmlJT1MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC5hY3RpdmVFbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hY3RpdmVFbGVtZW50LnZhbHVlID0gY3R4LmFjdGl2ZUVsZW1lbnQudmFsdWUgKyBcIiBcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hY3RpdmVFbGVtZW50LnZhbHVlID0gY3R4LmFjdGl2ZUVsZW1lbnQudmFsdWUudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlZiA9IGN0eC5zY2VuZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gMCwgbGVuID0gcmVmLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lID0gcmVmW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LmlucHV0Rm9jdXMgfHwgZm9yY2VVcGRhdGUgfHwgKHNjcm9sbFkgKyB3aW5kb3dIZWlnaHQgPj0gKHNjZW5lLmFnZW50T2Zmc2V0IHx8IHNjZW5lLm9mZnNldFRvcCkgKyBkZWx0YVNjcm9sbCAmJiBzY3JvbGxZIDw9IChzY2VuZS5hZ2VudE9mZnNldCB8fCBzY2VuZS5vZmZzZXRUb3ApICsgKHNjZW5lLmFnZW50SGVpZ2h0IHx8IHNjZW5lLm9mZnNldEhlaWdodCkgKyBkZWx0YVNjcm9sbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLnVwZGF0ZShzY3JvbGxZLCB3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBkb2N1bWVudEhlaWdodCwgY3R4LmlucHV0Rm9jdXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5sYXN0U2Nyb2xsWSA9IHNjcm9sbFk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0eC5pc0FjdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgUkRQYXJhbGxheC5wcm90b3R5cGUuY2hlY2tSZXNpemUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjdHg7XHJcbiAgICAgICAgICAgICAgICBjdHggPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvY0hlaWdodCwgaywgbCwgbGF5ZXIsIGxlbiwgbGVuMSwgcmVmLCByZWYxLCBzY2VuZTtcclxuICAgICAgICAgICAgICAgICAgICBkb2NIZWlnaHQgPSBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICByZWYgPSBjdHguc2NlbmVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGsgPCBsZW47IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZSA9IHJlZltrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmMSA9IHNjZW5lLmxheWVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsID0gMCwgbGVuMSA9IHJlZjEubGVuZ3RoOyBsIDwgbGVuMTsgbCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllciA9IHJlZjFbbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGF5ZXIuaXNIb2xkZXJXcm9uZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmNoZWNrTGF5ZXJIZWlnaHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHguY2hlY2tMYXllckhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC5jaGVja0xheWVySGVpZ2h0IHx8IGRvY0hlaWdodCAhPT0gY3R4Lmxhc3REb2NIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnJlc2l6ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4Lmxhc3REb2NIZWlnaHQgPSBkb2NIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHguY2hlY2tMYXllckhlaWdodCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gUkRQYXJhbGxheDtcclxuXHJcbiAgICAgICAgfSkoKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGpRdWVyeSBQbHVnaW4gZm9yIHRoZSBSRCBQYXJhbGxheFxyXG4gICAgICAgICAqIEBwdWJsaWNcclxuICAgICAgICAgKi9cclxuICAgICAgICAkLlJEUGFyYWxsYXggPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHZhciAkZG9jO1xyXG4gICAgICAgICAgICAkZG9jID0gJChkb2N1bWVudCk7XHJcbiAgICAgICAgICAgIGlmICghJGRvYy5kYXRhKCdSRFBhcmFsbGF4JykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkZG9jLmRhdGEoJ1JEUGFyYWxsYXgnLCBuZXcgUkRQYXJhbGxheChvcHRpb25zKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB3aW5kb3cuUkRQYXJhbGxheCA9IFJEUGFyYWxsYXg7XHJcbiAgICB9KSh3aW5kb3cualF1ZXJ5LCBkb2N1bWVudCwgd2luZG93KTtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgUGx1Z2luIEFNRCBleHBvcnRcclxuICAgICAqIEBwdWJsaWNcclxuICAgICAqL1xyXG5cclxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiICYmIG1vZHVsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gd2luZG93LlJEUGFyYWxsYXg7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG4gICAgICAgIGRlZmluZShbXCJqcXVlcnlcIl0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuUkRQYXJhbGxheDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn0pLmNhbGwodGhpcyk7Il19
